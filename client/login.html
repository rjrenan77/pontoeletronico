<!DOCTYPE html>
<html class="no-js">
<!--<![endif]-->

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title> CRO-RJ Sistema de Ponto Eletrônico</title>
    <link rel="stylesheet" type="text/css" href="public/css/estiloLogin.css">
</head>

<body>
    <div>
        <form>
            <div>


                <div class="login-wrap">

                    <div class="login-html">
                        <p id="msgValidacao"></p>
                        <input id="tab-1" type="radio" name="tab" class="sign-in" checked><label for="tab-1"
                            class="tab">SISTEMA DE REGISTRO DE PONTO - CRO-RJ</label>

                        <input id="tab-2" type="radio" name="tab" class="sign-up"><label for="tab-2"
                            class="tab"></label>

                        <div class="login-form">
                            <div class="sign-in-htm">
                                <div class="group">
                                    <label for="user" class="label">USUÁRIO</label>
                                    <input type="text" id="usuario" name="usuario"
                                        placeholder="Digite seu usuário..." />

                                </div>
                                <div class="group">
                                    <label for="pass" class="label">SENHA</label>
                                    <input type="password" id="senha" name="senha" placeholder="Digite sua senha ....">
                                </div>
                                <div class="group">
                                    <button type="submit" id="botaoLogin" name="botaoLogin">Acessar</button>

                                </div>
                                <div class="hr"></div>



                            </div>

                        </div>
                    </div>
                </div>

            </div>


        </form>

    </div>


    <script>

        document.getElementById("botaoLogin").addEventListener("click", function (event) {
            event.preventDefault();

            var formData = new FormData();

            var usuario = document.getElementById("usuario").value;
            var senha = document.getElementById("senha").value;



            formData.append("usuario", usuario);
            formData.append("senha", senha);


            var xhr = new XMLHttpRequest();

            xhr.onreadystatechange = function () {

                if (xhr.readyState == 4) {
                    var resposta = xhr.responseText;
                    console.log(resposta)

                    //talvez sirva para recarregar a pagina
                    xhr.onload = function () {
                        if (resposta === "401") {
                            var msgValidacao = document.getElementById("msgValidacao");
                            msgValidacao.innerHTML = "ATENÇÃO: Usuário ou Senha Inválidos!"


                        }

                        if (resposta === "autorizado") {
                            console.log("entraaaaa")
                            location.replace("./index.html");
                            // window.open("index.html","_blank");

                        }

                        if (resposta === "naoautorizado") {
                            var msgValidacao = document.getElementById("msgValidacao");
                            msgValidacao.innerHTML = "ATENÇÃO: Usuário ou Senha não autorizados. Procure o administrador do sistema."


                        }
                    }


                    //  document.write(Date());



                }
            }

            xhr.open("POST", "http://localhost:8080/api/autenticar");
            xhr.send(formData);

            // location.reload()


        });



    </script>


</body>

</html>